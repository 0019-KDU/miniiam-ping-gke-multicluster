# =============================================================================
# Istio Sidecar Configuration
# Exclude LDAP ports from Istio proxy to allow raw TCP for replication
# =============================================================================
apiVersion: networking.istio.io/v1beta1
kind: Sidecar
metadata:
  name: pingdirectory-sidecar
  namespace: ping-iam
spec:
  workloadSelector:
    labels:
      app.kubernetes.io/name: pingdirectory
  outboundTrafficPolicy:
    mode: ALLOW_ANY
  egress:
    - hosts:
        - "./*"
        - "istio-system/*"
      port:
        number: 1389
        protocol: TCP
        name: ldap
    - hosts:
        - "./*"
        - "istio-system/*"
